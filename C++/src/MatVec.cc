#include"../include/MatVec.h"

/********************************************************************* 
 * Data de criacao    : 03/10/2020                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * alloc : inicializado e alocando o vetor                           * 
 *-------------------------------------------------------------------* 
 * Parametros de entrada:                                            * 
 *-------------------------------------------------------------------* 
 * nLin   - numero de linhas                                         *
 * name   - nome do arranjo                                          * 
 *-------------------------------------------------------------------* 
 * Parametros de saida:                                              * 
 *-------------------------------------------------------------------* 
 *-------------------------------------------------------------------* 
 * OBS:                                                              * 
 *-------------------------------------------------------------------*
 *********************************************************************/
void Vector::alloc(const int nLin, string name) {
      
  this->nLin = nLin;
  this->name = name;
  try{
    this->coef = new double[nLin];
  }
  catch (bad_alloc E){
    cout << "Nao ha memoria suficiente" << this->name << endl;
  }

}
/********************************************************************/

/********************************************************************* 
 * Data de criacao    : 03/10/2020                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * getCoef : retorna o coeficiente i                                 * 
 *-------------------------------------------------------------------* 
 * Parametros de entrada:                                            * 
 *-------------------------------------------------------------------* 
 * i      - vetor x                                                  *
 *-------------------------------------------------------------------* 
 * Parametros de saida:                                              * 
 *-------------------------------------------------------------------* 
 *-------------------------------------------------------------------* 
 * OBS:                                                              * 
 *-------------------------------------------------------------------* 
 *********************************************************************/
double Vector::getCoef(int i) const{
  return this->coef[ i ];
}
/********************************************************************/

/********************************************************************* 
 * Data de criacao    : 03/10/2020                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * setCoef : set o coeficiente i                                     * 
 *-------------------------------------------------------------------* 
 * Parametros de entrada:                                            * 
 *-------------------------------------------------------------------* 
 * i      - vetor x                                                  *
 * a      - valor do coeficiente                                     * 
 *-------------------------------------------------------------------* 
 * Parametros de saida:                                              * 
 *-------------------------------------------------------------------* 
 *-------------------------------------------------------------------* 
 * OBS:                                                              * 
 *-------------------------------------------------------------------* 
 *********************************************************************/
void Vector::setCoef(int i, double a){
  this->coef[ i ] = a;
}
/********************************************************************/

/*********************************************************************/ 
double* Vector::data(void) const{
  return this->coef;
}
/********************************************************************/

/*********************************************************************/ 
ostream& operator<<(ostream& os, Vector &x){
  
  int n;

  x.dim(n);

  for (int i = 0; i < n; i++) {
    os << x.name <<"[" << i << "]" << " = " << x.coef[i] << endl;
  }

  return os;
}
/********************************************************************/

/********************************************************************/
void Vector::dealloc() {
  
  if(this->coef){
    delete [] this->coef;
    this->coef = nullptr;
  }
}
/********************************************************************/

/********************************************************************/
Vector::~Vector() {
  cout<< "chamando destrutor para "<< this->name << '.' << endl; 
  this->dealloc();
}
/********************************************************************/

/********************************************************************/
void Vector::dim(int &nLin) const{
  
  nLin = this->nLin; 
  
}
/********************************************************************/

/*********************************************************************/ 
double& Vector::operator[](const int i) const{
  return this->coef[i];
}
/********************************************************************/

/********************************************************************* 
 * Data de criacao    : 03/10/2020                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * alloc : inicializado e alocando a matriz                          * 
 *-------------------------------------------------------------------* 
 * Parametros de entrada:                                            * 
 *-------------------------------------------------------------------* 
 * nLin   - numero de linhas                                         *
 * nCol   - numero de colunas                                        *
 * name   - nome do arranjo                                          * 
 *-------------------------------------------------------------------* 
 * Parametros de saida:                                              * 
 *-------------------------------------------------------------------* 
 *-------------------------------------------------------------------* 
 * OBS:                                                              * 
 *-------------------------------------------------------------------* 
 *********************************************************************/
void Matrix::alloc(const int nLin, const int nCol, string name) {
  
  this->nLin = nLin;
  this->nCol = nLin;
  this->name = name;

  try{
    this->coef = new double[nLin*nCol];
  }
  catch (bad_alloc E){
    cout << "Não há memoria suficiente" << this->name << endl;
  }

}
/********************************************************************/

/********************************************************************* 
 * Data de criacao    : 03/10/2020                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * getCoef : retorna o coeficiente i, j                              * 
 *-------------------------------------------------------------------* 
 * Parametros de entrada:                                            * 
 *-------------------------------------------------------------------* 
 * i      - vetor x                                                  *
 * j      - indefinido                                               *
 *-------------------------------------------------------------------* 
 * Parametros de saida:                                              * 
 *-------------------------------------------------------------------* 
 *-------------------------------------------------------------------* 
 * OBS:                                                              * 
 *-------------------------------------------------------------------* 
 *********************************************************************/
double Matrix::getCoef(int i, int j) const{
  return this->coef[ i * this->nCol + j];
}
/********************************************************************/

/********************************************************************* 
 * Data de criacao    : 03/10/2020                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * setCoef : set o coeficiente i, j                                  * 
 *-------------------------------------------------------------------* 
 * Parametros de entrada:                                            * 
 *-------------------------------------------------------------------* 
 * i      - vetor x                                                  *
 * j      - indefinido                                               *
 * a      - valor do coeficiente                                     * 
 *-------------------------------------------------------------------* 
 * Parametros de saida:                                              * 
 *-------------------------------------------------------------------* 
 *-------------------------------------------------------------------* 
 * OBS:                                                              * 
 *-------------------------------------------------------------------* 
 *********************************************************************/
void Matrix::setCoef(int i, int j, double a){
  this->coef[ i * this->nCol + j] = a;
}
/********************************************************************/

/********************************************************************* 
 * Data de criacao    : 03/10/2020                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * MATVEC : operacao matriz vetor para matriz cheias                 * 
 *-------------------------------------------------------------------* 
 * Parametros de entrada:                                            * 
 *-------------------------------------------------------------------* 
 * x      - vetor x                                                  *
 * y      - indefinido                                               *
 * transp - matriz transposta                                        * 
 *-------------------------------------------------------------------* 
 * Parametros de saida:                                              * 
 *-------------------------------------------------------------------* 
 * y  - produto vetoria entre a e x                                  * 
 *-------------------------------------------------------------------* 
 * OBS:                                                              * 
 *-------------------------------------------------------------------* 
 *********************************************************************/
Vector& Matrix::matVec(Vector& x, Vector& y, bool transp) const{

  int nl = this->nLin;
  int nc = this->nCol;
  double tmp = 0.e0;
  double *a  = this->data();

/*... transposta*/
  if(transp)
    for (int i = 0; i < nc; i++) {
      tmp = 0.e0;
      for (int j = 0; j < nl; j++) 
        tmp += a[j * nl + i] * x[j];

      y[i] = tmp;
    }
/*...................................................................*/

/*...*/
  else
    for (int i = 0; i < nl; i++) {
      tmp = 0.e0;
      for (int j = 0; j < nc; j++) 
        tmp += a[i * nl +  j] * x[j];
      y[i] = tmp;
    }
/*...................................................................*/ 

  return y;

}
/********************************************************************/

/*********************************************************************/ 
ostream& operator<<(ostream& os, Matrix &x){
  
  int nl, nc;

  x.dim(nl, nc);

  for (int i = 0; i < nl; i++)
    for (int j = 0; j < nc; j++)
      os << x.name <<"[" << i << "]" << "[" << i << "]" 
         << " = " << x.coef[i * nl + j] << endl;
  

  return os;
}
/********************************************************************/

/********************************************************************/
void Matrix::dim(int &nLin, int &nCol) const {
  
  nLin = this->nLin;
  nCol = this->nCol; 
  
}
/********************************************************************/

